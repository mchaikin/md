function loadSettings(e){if($.each(e,function(e,t){c.push(t)}),c.length<=0)return $(".preloader .text_area").html('<span style="color: red;"><div style="font-weight: 500;">NO CHANNELS DEFINED</div>Unable to find channels, please create one!</span>'),!1;c.length>1&&($(".channels").show(),$.each(c,function(e,t){tmp.html=$('<li><a tabindex="1" href="#'+t.name+'">'+t.name+"</a></li>"),$(".channel-list").append(tmp.html),tmp.html.on("click",function(){loadChannel($(this).text())})}));var t=window.location.hash.replace("#","");if(""!=t&&loadChannel(t),""==t&&"true"==s.usecookies){var a=getcookie("lastchannel");null!=a&&loadChannel(a,!0)}""==t&&null==a&&null!=s.default_channel&&loadChannel(s.default_channel,!0),null==s.channel.name&&loadChannel(c[0].name),$(".preloader").addClass("loadComplete")}function loadChannel(e,t){if(s.channel.name==e)return!1;for(i=0;i<c.length;i++)if(c[i].name==e)var a=i;if("number"!=typeof a)return t!==!0&&alert("Invalid Channel!"),console.log("Invalid channel: "+e),!1;if($(".channel-list li > a").removeClass("active"),$(".channel-list li").find('a[href="#'+e+'"]').addClass("active"),s.channel=c[a],setcookie("lastchannel",e,365),$("#maintheme").attr("href","assets/css/"+s.channel.skin),null!=s.channel.logo&&""!=s.channel.logo){var n=new Image;n.src=s.channel.logo,n.onload=function(){$(".header .logo a img").attr("src",s.channel.logo)}}else $(".header .logo a img").attr("src","assets/img/logo.png");if($(".playlists a").each(function(){$(this).attr("href",$(this).attr("href").replace(/c=(.*)/,"c="+e))}),tmp.onair=null,$(".artist-preload").show(),$(".onair .time").html("00:00"),"true"==s.usecookies){var l=getcookie("quality");null!=l&&(tmp.quality=l)}else tmp.quality=null;if(null==tmp.quality||""==tmp.quality||null==s.channel.streams[tmp.quality])for(tmp.quality in s.channel.streams)break;$.map(s.channel.streams,function(e,t){return t}).length>1?($(".settings").show(),$(".streams-list").empty(),$.each(s.channel.streams,function(e,t){tmp.html=$('<li><a tabindex="1" href="#">'+e+"</a></li>"),$(".streams-list").append(tmp.html),tmp.quality==e&&tmp.html.find("a").addClass("active"),tmp.html.on("click",function(){return $(".streams-list li > a").removeClass("active"),$(this).find("a").addClass("active"),tmp.quality=$(this).text(),setcookie("quality",tmp.quality,365),initPlayer(),!1})})):$(".settings").hide(),clearInterval(tmp.radioinfo),tmp.radioinfo=setInterval(radioInfo,1e3*parseInt(s.stats_refresh)),radioInfo(),initPlayer(),txt(s.lang["status-stopped"],!0)}function initPlayer(){var e,t,a,t="";e="html, flash";var n=new Array;$.each(s.channel.streams[tmp.quality],function(e,t){n.push(e)}),t=n.join(", "),"true"==s.autoplay&&(a="play");var l=getcookie("volume");if(l=null!=l?l:"0.5",null==s.channel.streams[tmp.quality])return alert("ERROR: There has been issue with player configuration !"),!1;$("#jplayer-object").jPlayer("destroy");var o=$("#jplayer-object"),r=!1;o.jPlayer({swfPath:"assets/flash/jquery.jplayer.swf",solution:e,supplied:t,smoothPlayBar:!1,errorAlerts:!1,cssSelectorAncestor:"",volume:l,preload:"none",cssSelector:{play:".play",pause:".stop",mute:".volume-icon #volume",unmute:".volume-icon #muted",volumeBar:".volume-slider .vol-progress",volumeBarValue:".volume-slider .vol-progress .vol-bar"},ready:function(e){return e.jPlayer.status.noVolume&&($(".volume-control").addClass("no-volume"),$(".volume-slider .player-status").css({"margin-top":"0"})),r=!0,null==s.channel.streams[tmp.quality]?(alert("ERROR: There has been issue with player configuration !"),!1):void $(this).jPlayer("setMedia",s.channel.streams[tmp.quality]).jPlayer(a)},pause:function(){$(this).jPlayer("clearMedia"),txt(s.lang["status-stopped"],!0)},error:function(e){r&&e.jPlayer.error.type===$.jPlayer.error.URL_NOT_SET?$(this).jPlayer("setMedia",s.channel.streams[tmp.quality]).jPlayer("play"):r&&e.jPlayer.error.type===$.jPlayer.error.URL?txt("ERROR: Unable to load stream!",!0):($(".preloader").removeClass("loadComplete").css({visibility:"visible",opacity:1}),$(".preloader .text_area").html('<span style="color: red;"><div style="font-weight: 500;">PLAYBACK ERROR</div> '+e.jPlayer.error.message+"</span>"))},volumechange:function(e){e.jPlayer.options.muted?($(".volume-icon #volume").hide(),$(".volume-icon #muted").show()):($(".volume-icon #muted").hide(),$(".volume-icon #volume").show()),txt(e.jPlayer.options.muted?s.lang["status-muted"]:s.lang["status-volume"].replace("{LEVEL}",Math.floor(100*e.jPlayer.options.volume)+"%")),setcookie("volume",parseFloat(e.jPlayer.options.volume).toFixed(2),365)}}),$(".volume-control").mousedown(function(){parent=$(".volume-slider .vol-progress"),$("body").css({"-ms-user-select":"none","-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}),$(document).mousemove(function(e){if(e.pageX-$(parent).offset().left<1)return!1;var t=$(".volume-slider .vol-progress").width();o.jPlayer("option","muted",!1),o.jPlayer("option","volume",(e.pageX-$(parent).offset().left+1)/t),tmp.moving=!0}),$(document).mouseup(function(){$("body").removeAttr("style"),$(document).unbind("mousemove")})}),$(".playlists a").unbind("click").on("click",function(){1==r&&(o.jPlayer("clearMedia"),txt(s.lang["status-stopped"],!0))}),o.unbind($.jPlayer.event.play),o.unbind($.jPlayer.event.playing),o.bind($.jPlayer.event.play,function(e){txt(s.lang["status-init"].replace("{STREAM}",s.channel.name),!0)}),o.bind($.jPlayer.event.playing,function(e){txt(s.lang["status-playing"].replace("{STREAM}",s.channel.name),!0)})}function radioInfo(){return null==s.channel.name?!1:void $.ajax({url:"index.php?c="+s.channel.name,cache:!1,dataType:"json",timeout:1e3*parseInt(s.stats_refresh)-1e3,success:function(e){if(null==tmp.onair&&(tmp.onair={}),null==e.artist||null==e.title)return!1;if(e.artist==tmp.onair.artist&&e.title==tmp.onair.title)return!1;if($(".stats .artist").html('<a class="css-hint" data-title="'+e.artist+'" href="#">'+shorten(e.artist,s.artist_length)+"</a>"),$(".stats .title").html('<a class="css-hint" data-title="'+e.title+'" href="#">'+shorten(e.title,s.title_length)+"</a>"),$(".artist-preload").show(),$("#artist-img").attr("src",e.image).one("load",function(){$(".artist-preload").hide()}),"true"==s.dynamic_title&&(null==tmp.ptitle&&(tmp.ptitle=document.title),document.title=e.artist+" - "+e.title+" | "+tmp.ptitle),e.artist==s.default_artist&&e.title==s.default_title)var t=""+s.title+" #"+s.channel.name;else var t='"'+e.artist+" - "+e.title+'"';var a=window.location.href.split("#")[0];tmp["facebook-url"]="https://www.facebook.com/sharer/sharer.php?u="+a,tmp["twitter-url"]="https://twitter.com/share?url="+a+"&text="+encodeURIComponent(s.lang["twitter-share"].replace("{TRACK}",t)),tmp.onair=e,tmp.onair.timer=(new Date).getTime(),onairTime(),null!=e.status&&"disabled"==e.status&&clearInterval(tmp.radioinfo)}}).fail(function(e,t,a){$(".artist-preload").hide(),console.log("Request Failed: "+t+", "+a)})}function onairTime(){return clearInterval(tmp.timer),1!=s.channel["show-time"]?($(".onair .time").html("00:00").hide(),!1):void(tmp.timer=setInterval(function(){if(1!=s.channel["show-time"])return clearInterval(tmp.timer),$(".onair .time").hide(),!1;if(null==tmp.onair||"number"!=typeof tmp.onair.timer)return!1;var e=((new Date).getTime()-tmp.onair.timer)/1e3,t=Math.floor(e/3600%60)>10?Math.floor(e/3600%60):"0"+Math.floor(e/3600%60),a=Math.floor(e/60%60)>10?Math.floor(e/60%60):"0"+Math.floor(e/60%60),n=e%60>10?Math.floor(e%60):"0"+Math.floor(e%60);t>=1?timer=t+":"+a+":"+n:timer=a+":"+n,$(".onair .time").show().html(timer)},1e3))}function txt(e,t){var a=$(".player-status");(1==t||void 0==typeof tmp["txt-status"])&&(tmp["txt-status"]=e),null!=tmp.txtobj&&clearTimeout(tmp.txtobj),a.html(e),null==t&&(tmp.txtobj=setTimeout(function(){a.hide().html(tmp["txt-status"]).fadeIn("slow")},2e3))}function shorten(e,t){if("0"==t)return e;var a=t||10;return e.length>a&&(e=e.substring(0,a)+"&hellip;"),e}function setcookie(e,t,a,n,l,o){if("true"!=s.usecookies)return null;var r=new Date;r.setTime(r.getTime()),a&&(a=1e3*a*60*60*24);var i=new Date(r.getTime()+a);document.cookie=e+"="+escape(t)+(a?";expires="+i.toGMTString():"")+(n?";path="+n:"")+(l?";domain="+l:"")+(o?";secure":"")}function getcookie(e){if("true"!=s.usecookies)return null;var t=document.cookie.indexOf(e+"="),a=t+e.length+1;if(!t&&e!=document.cookie.substring(0,e.length))return null;if(-1==t)return null;var n=document.cookie.indexOf(";",a);return-1==n&&(n=document.cookie.length),unescape(document.cookie.substring(a,n))}function delcookie(e,t,a){return"true"!=s.usecookies?null:void(getcookie(e)&&(document.cookie=e+"="+(t?";path="+t:"")+(a?";domain="+a:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"))}function isTouchDevice(){return"undefined"!=typeof window.ontouchstart}var tmp={},c=new Array;$(function(){return"undefined"==typeof s||"true"==s.setup?($(".preloader .text_area").html('<span style="color: red;"><div style="font-weight: 500;">ERROR OCCURED</div>Unable to read player configuration!</span>'),!1):($.getJSON("?c=all",loadSettings).fail(function(e,t,a){return console.log("Request Failed: "+t+", "+a),$(".preloader .text_area").html('<span style="color: red;"><div style="font-weight: 500;">ERROR OCCURED</div>Unable to load player configuration!</span>'),!1}),$(".share-area .facebook, .share-area .twitter").on("click",function(){return null==tmp["facebook-url"]||null==tmp["twitter-url"]?!1:(window.open($(this).hasClass("facebook")?tmp["facebook-url"]:tmp["twitter-url"],"share","width=800, height=400"),!1)}),void $(".header li a").on("click",function(){var e=$(this);return $(e).hasClass("active")?$(e).removeClass("active").next("ul").removeClass("active"):($(".header > ul > li > a").removeClass("active"),$(".header > ul > li > ul").removeClass("active"),$(e).addClass("active").next("ul").addClass("active"),$(document).on("click",function(){$(e).removeClass("active").next("ul").removeClass("active"),$(".stats, .player").unbind("click")})),!1}))});
